<!DOCTYPE html>
<html>
<head>
  <title>VTF Audio Extension - Settings</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="options-page">
  <div class="options-header">
    <h1>VTF Audio Extension Settings</h1>
    <div class="version-info">Version 2.0.0</div>
  </div>
  
  <div class="options-container">
    <!-- API Configuration -->
    <section class="options-section">
      <h2>API Configuration</h2>
      
      <div class="form-group">
        <label for="apiKey">OpenAI API Key</label>
        <div class="input-group">
          <input type="password" id="apiKey" placeholder="sk-..." />
          <button id="toggleApiKey" class="btn-icon" title="Toggle visibility">üëÅÔ∏è</button>
        </div>
        <div class="help-text">
          Get your API key from <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI Platform</a>
        </div>
      </div>
      
      <div class="form-group">
        <label for="apiEndpoint">API Endpoint (Advanced)</label>
        <input type="url" id="apiEndpoint" placeholder="https://api.openai.com/v1/audio/transcriptions" />
        <div class="help-text">
          Leave blank to use default OpenAI endpoint
        </div>
      </div>
      
      <button id="saveApiBtn" class="btn btn-primary">Save API Settings</button>
    </section>
    
    <!-- Speaker Mapping -->
    <section class="options-section">
      <h2>Speaker Identification</h2>
      
      <div class="speaker-mappings" id="speakerMappings">
        <div class="speaker-mapping-header">
          <span>User ID</span>
          <span>Speaker Name</span>
          <span>Actions</span>
        </div>
        <!-- Dynamic speaker mappings will be inserted here -->
      </div>
      
      <div class="button-group">
        <button id="addSpeakerBtn" class="btn btn-secondary">+ Add Speaker</button>
        <button id="importSpeakersBtn" class="btn btn-secondary">Import</button>
        <button id="exportSpeakersBtn" class="btn btn-secondary">Export</button>
        <button id="autoLearnToggle" class="btn btn-secondary">Auto-Learn: <span id="autoLearnStatus">Off</span></button>
      </div>
    </section>
    
    <!-- Capture Settings -->
    <section class="options-section">
      <h2>Capture Settings</h2>
      
      <div class="form-group">
        <label>
          <input type="checkbox" id="autoStart" />
          Auto-start capture when visiting VTF
        </label>
      </div>
      
      <div class="form-group">
        <label for="bufferDuration">Buffer Duration</label>
        <div>
          <input type="range" id="bufferDuration" min="0.5" max="5" step="0.5" value="1.5" />
          <span id="bufferDurationValue">1.5s</span>
        </div>
        <div class="help-text">How long to buffer audio before sending to transcription</div>
      </div>
      
      <div class="form-group">
        <label for="silenceThreshold">Silence Detection Sensitivity</label>
        <select id="silenceThreshold">
          <option value="0.001">High (Default)</option>
          <option value="0.005">Medium</option>
          <option value="0.01">Low</option>
          <option value="0">Disabled</option>
        </select>
        <div class="help-text">Higher sensitivity = more silence detection</div>
      </div>
      
      <div class="form-group">
        <label for="silenceTimeout">Silence Timeout</label>
        <select id="silenceTimeout">
          <option value="1000">1 second</option>
          <option value="2000">2 seconds (Default)</option>
          <option value="3000">3 seconds</option>
          <option value="5000">5 seconds</option>
        </select>
        <div class="help-text">How long to wait before transcribing after silence</div>
      </div>
      
      <button id="saveCaptureBtn" class="btn btn-primary">Save Capture Settings</button>
    </section>
    
    <!-- Advanced Settings -->
    <section class="options-section">
      <h2>Advanced Settings</h2>
      
      <div class="form-group">
        <label>
          <input type="checkbox" id="debugMode" />
          Enable debug logging (Developer mode)
        </label>
      </div>
      
      <div class="form-group">
        <label>
          <input type="checkbox" id="performanceMode" />
          Show performance metrics in popup
        </label>
      </div>
      
      <div class="form-group">
        <label for="maxTranscriptions">Maximum stored transcriptions</label>
        <input type="number" id="maxTranscriptions" min="100" max="10000" step="100" value="1000" />
        <div class="help-text">Older transcriptions will be automatically removed</div>
      </div>
      
      <div class="form-group">
        <label for="maxRetries">Maximum API retry attempts</label>
        <input type="number" id="maxRetries" min="1" max="10" value="5" />
      </div>
      
      <button id="saveAdvancedBtn" class="btn btn-primary">Save Advanced Settings</button>
    </section>
    
    <!-- Data Management -->
    <section class="options-section">
      <h2>Data Management</h2>
      
      <div class="stats-display" id="statsDisplay">
        <div class="stat-row">
          <span class="stat-label">Total Transcriptions:</span>
          <span class="stat-value" id="totalTranscriptions">0</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Storage Used:</span>
          <span class="stat-value" id="storageUsed">0 KB</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Known Speakers:</span>
          <span class="stat-value" id="knownSpeakers">0</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Service Uptime:</span>
          <span class="stat-value" id="serviceUptime">Not running</span>
        </div>
      </div>
      
      <div class="button-group mt-lg">
        <button id="exportDataBtn" class="btn btn-secondary">Export All Data</button>
        <button id="importDataBtn" class="btn btn-secondary">Import Data</button>
        <button id="clearTranscriptionsBtn" class="btn btn-secondary">Clear Transcriptions</button>
        <button id="resetSettingsBtn" class="btn btn-danger">Reset All Settings</button>
      </div>
    </section>
  </div>
  
  <!-- Status messages -->
  <div class="message-container">
    <div class="success-message hidden" id="successMessage"></div>
    <div class="error-message hidden" id="errorMessage"></div>
  </div>
  
  <!-- Add Speaker Modal -->
  <div id="addSpeakerModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add Speaker Mapping</h3>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="newUserId">User ID</label>
          <input type="text" id="newUserId" placeholder="e.g., XRcupJu26dK_sazaAAPK" />
        </div>
        <div class="form-group">
          <label for="newSpeakerName">Speaker Name</label>
          <input type="text" id="newSpeakerName" placeholder="e.g., John Doe" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="document.getElementById('addSpeakerModal').classList.remove('show')">Cancel</button>
        <button id="confirmAddSpeaker" class="btn btn-primary">Add Speaker</button>
      </div>
    </div>
  </div>
  
  <!-- Hidden file input for imports -->
  <input type="file" id="importFileInput" accept=".json" class="hidden" />
  
  <script src="options.js"></script>
</body>
</html>